pipeline {
    agent {
        node {
            label 'slave1'
        }
    }

    parameters {
        imageTag(name: 'myroslavlevchyk/petclinic', 
                 image: 'myroslavlevchyk/petclinic')    
    }

    stages {
        stage('Delete workspace before build starts') {
            steps {
                echo 'Deleting workspace'
                deleteDir()
            }
        }
        stage('Env print BRANCH') {
            steps {
                sh '''
                    echo $BRANCH
                '''
            }
        }

        stage('Env print DOCKER image') {
            steps {
                sh '''
                    echo $DOCKER_IMAGE
                '''
            }
        }        

        stage('Env print BRANCH2') {
            steps {
                sh '''
                    echo "${params.BRANCH}"
                '''
            }
        }

        stage('Env print DOCKER image') {
            steps {
                sh '''
                    echo "${params.DOCKER_IMAGE}"
                '''
            }
        }

        stage('Checkout') {
            steps{
                    git branch: "${params.BRANCH}", credentialsId: 'ssh-github', url: 'git@github.com:myroslavlevchyk/4pet.git'      
                }
        }            
   
    }
}
